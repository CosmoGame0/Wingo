<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BDG WIN - WinGo Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        /* Mobile Viewport Container */
        .mobile-container {
            width: 400px;
            max-width: 100%;
            background: #242424;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            overflow: hidden;
            position: relative;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            padding: 16px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 22px;
            font-weight: bold;
            color: #242424;
        }

        .settings-icon {
            font-size: 24px;
            cursor: pointer;
            color: #242424;
            transition: transform 0.3s;
        }

        .settings-icon:hover {
            transform: rotate(90deg);
        }

        /* Wallet Section */
        .wallet-section {
            background: #333332;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid #4D4D4C;
        }

        .wallet-info {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }

        .wallet-label {
            font-size: 12px;
            color: #A8A5A1;
        }

        .wallet-balance {
            font-size: 28px;
            font-weight: bold;
            color: #d9ac4f;
        }

        .wallet-actions {
            display: flex;
            gap: 8px;
        }

        .wallet-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            font-size: 13px;
            transition: all 0.3s;
        }

        .deposit-btn {
            background: #17B15E;
            color: white;
        }

        .withdraw-btn {
            background: #FD565C;
            color: white;
        }

        /* Game Mode Tabs */
        .game-modes {
            display: flex;
            background: #333332;
            padding: 12px 20px;
            gap: 8px;
            overflow-x: auto;
            border-bottom: 1px solid #4D4D4C;
        }

        .mode-tab {
            padding: 8px 16px;
            border: 1px solid #4D4D4C;
            border-radius: 6px;
            background: #242424;
            color: #A8A5A1;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.3s;
        }

        .mode-tab.active {
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            color: #242424;
            border-color: #d9ac4f;
        }

        /* Game Area */
        .game-area {
            padding: 20px;
            background: #242424;
        }

        /* Period & Timer */
        .game-info {
            background: #333332;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .period-display {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .period-label {
            font-size: 13px;
            color: #A8A5A1;
        }

        .period-number {
            font-size: 15px;
            font-weight: bold;
            color: #d9ac4f;
            font-family: monospace;
        }

        .countdown {
            text-align: center;
        }

        .countdown-label {
            font-size: 12px;
            color: #A8A5A1;
            margin-bottom: 8px;
        }

        .countdown-timer {
            font-size: 48px;
            font-weight: bold;
            color: #d9ac4f;
            font-variant-numeric: tabular-nums;
        }

        /* Number Grid */
        .numbers-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .number-ball {
            aspect-ratio: 1;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 28px;
            font-weight: bold;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .number-ball::before {
            content: '';
            position: absolute;
            top: 15%;
            left: 20%;
            width: 35%;
            height: 35%;
            border-radius: 50%;
            background: radial-gradient(circle at 50% 50%, rgba(255, 255, 255, 0.4), transparent 70%);
        }

        .number-ball:hover {
            transform: scale(1.1);
        }

        .number-ball.red {
            background: radial-gradient(circle at 35% 35%, #FD565C 0%, #D23838 50%, #B82E2E 100%);
        }

        .number-ball.green {
            background: radial-gradient(circle at 35% 35%, #40AD72 0%, #17B15E 50%, #139A4F 100%);
        }

        .number-ball.violet {
            background: radial-gradient(circle at 35% 35%, #B77FE8 0%, #9B48DB 50%, #7B2BB8 100%);
        }

        /* Color Betting */
        .color-betting {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .color-bet-btn {
            padding: 16px;
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .color-bet-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
        }

        .color-bet-btn.green {
            background: linear-gradient(135deg, #40AD72 0%, #17B15E 100%);
        }

        .color-bet-btn.violet {
            background: linear-gradient(135deg, #B77FE8 0%, #9B48DB 100%);
        }

        .color-bet-btn.red {
            background: linear-gradient(135deg, #FD565C 0%, #D23838 100%);
        }

        /* Big/Small Betting */
        .size-betting {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 20px;
        }

        .size-bet-btn {
            padding: 16px;
            border: 2px solid #4D4D4C;
            border-radius: 12px;
            background: #333332;
            color: #F5F3F0;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .size-bet-btn:hover {
            border-color: #d9ac4f;
            background: #4D4D4C;
        }

        /* Game History */
        .game-history {
            background: #333332;
            border-radius: 12px;
            margin-bottom: 20px;
            overflow: hidden;
        }

        .history-tabs {
            display: flex;
            background: #2A2A2A;
            border-bottom: 2px solid #525167;
        }

        .history-tab {
            flex: 1;
            padding: 14px;
            border: none;
            background: transparent;
            color: #A8A5A1;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .history-tab.active {
            color: #d9ac4f;
            background: #333332;
            border-bottom-color: #d9ac4f;
        }

        .history-content {
            padding: 0;
        }

        .history-table-container {
            overflow-x: auto;
            max-height: 500px;
            overflow-y: auto;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
        }

        .history-table thead {
            background: #4D4D4C;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .history-table th {
            padding: 15px;
            text-align: left;
            font-size: 14px;
            font-weight: bold;
            color: #F5F3F0;
            border-bottom: 2px solid #525167;
        }

        .history-table th:nth-child(1) {
            width: 35%;
        }

        .history-table th:nth-child(2) {
            width: 20%;
            text-align: center;
        }

        .history-table th:nth-child(3) {
            width: 25%;
            text-align: center;
        }

        .history-table th:nth-child(4) {
            width: 20%;
            text-align: center;
        }

        .history-table tbody tr {
            background: #2A2A2A;
            border-bottom: 1px solid #525167;
            transition: background 0.2s;
        }

        .history-table tbody tr:nth-child(even) {
            background: #242424;
        }

        .history-table tbody tr:hover {
            background: #3A3A3A;
        }

        .history-table td {
            padding: 15px;
            color: #F5F3F0;
        }

        .history-period-cell {
            font-size: 14px;
            color: #A8A5A1;
            font-family: monospace;
        }

        .history-number-cell {
            text-align: center;
            font-size: 24px;
            font-weight: bold;
        }

        .history-number-cell.red {
            color: #FD565C;
        }

        .history-number-cell.green {
            color: #40AD72;
        }

        .history-number-cell.violet {
            color: #9B48DB;
        }

        .history-size-cell {
            text-align: center;
            font-size: 14px;
            color: #F5F3F0;
        }

        .history-color-cell {
            text-align: center;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
        }

        .color-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            display: inline-block;
        }

        .color-dot.red {
            background: #FD565C;
        }

        .color-dot.green {
            background: #40AD72;
        }

        .color-dot.violet {
            background: #9B48DB;
        }

        .history-pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 16px;
            background: #2A2A2A;
            border-top: 1px solid #525167;
        }

        .pagination-btn {
            width: 36px;
            height: 36px;
            border: 2px solid #4D4D4C;
            border-radius: 6px;
            background: #333332;
            color: #F5F3F0;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s;
        }

        .pagination-btn:hover:not(:disabled) {
            border-color: #d9ac4f;
            background: #4D4D4C;
        }

        .pagination-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .pagination-info {
            font-size: 14px;
            font-weight: 600;
            color: #F5F3F0;
        }

        .empty-history {
            text-align: center;
            padding: 40px 20px;
            color: #A8A5A1;
            font-size: 14px;
        }

        /* Betting Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal.show {
            display: flex;
        }

        .modal-content {
            background: #333332;
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            padding: 20px;
            border-bottom: 1px solid #4D4D4C;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
            color: #F5F3F0;
        }

        .close-btn {
            font-size: 28px;
            color: #A8A5A1;
            cursor: pointer;
            line-height: 1;
        }

        .modal-body {
            padding: 20px;
        }

        /* Bet Amount Selection */
        .quick-amounts {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .amount-btn {
            padding: 12px;
            border: 2px solid #4D4D4C;
            border-radius: 8px;
            background: #242424;
            color: #F5F3F0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .amount-btn.active {
            border-color: #d9ac4f;
            background: #d9ac4f;
            color: #242424;
        }

        /* Quantity Selector */
        .quantity-selector {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 20px;
        }

        .quantity-label {
            font-size: 14px;
            color: #A8A5A1;
        }

        .quantity-controls {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .quantity-btn {
            width: 32px;
            height: 32px;
            border: 2px solid #4D4D4C;
            border-radius: 6px;
            background: #242424;
            color: #F5F3F0;
            font-size: 18px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .quantity-value {
            font-size: 18px;
            font-weight: bold;
            color: #F5F3F0;
            min-width: 30px;
            text-align: center;
        }

        /* Multiplier Selection */
        .multiplier-section {
            margin-bottom: 20px;
        }

        .multiplier-label {
            font-size: 14px;
            color: #A8A5A1;
            margin-bottom: 8px;
        }

        .multiplier-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
        }

        .multiplier-btn {
            padding: 10px;
            border: 2px solid #4D4D4C;
            border-radius: 8px;
            background: #242424;
            color: #F5F3F0;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .multiplier-btn.active {
            border-color: #d9ac4f;
            background: #d9ac4f;
            color: #242424;
        }

        /* Total Amount */
        .total-amount {
            background: #242424;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: center;
        }

        .total-label {
            font-size: 12px;
            color: #A8A5A1;
            margin-bottom: 4px;
        }

        .total-value {
            font-size: 32px;
            font-weight: bold;
            color: #d9ac4f;
        }

        /* Confirm Buttons */
        .confirm-buttons {
            display: flex;
            gap: 8px;
        }

        .confirm-btn {
            flex: 1;
            padding: 16px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .confirm-btn.cancel {
            background: #4D4D4C;
            color: #F5F3F0;
        }

        .confirm-btn.submit {
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            color: #242424;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            color: #242424;
            padding: 16px 24px;
            border-radius: 12px;
            font-weight: bold;
            z-index: 2000;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.5);
            display: none;
            animation: slideDown 0.3s ease;
        }

        .notification.show {
            display: block;
        }

        .notification.success {
            background: linear-gradient(135deg, #40AD72 0%, #17B15E 100%);
            color: white;
        }

        .notification.error {
            background: linear-gradient(135deg, #FD565C 0%, #D23838 100%);
            color: white;
        }

        @keyframes slideDown {
            from {
                transform: translateX(-50%) translateY(-100px);
                opacity: 0;
            }
            to {
                transform: translateX(-50%) translateY(0);
                opacity: 1;
            }
        }

        /* Admin Panel Modal */
        .admin-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .admin-modal.show {
            display: flex;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .admin-modal-content {
            background: #242424;
            border-radius: 16px;
            width: 100%;
            max-width: 500px;
            max-height: 85vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid #d9ac4f;
        }

        .admin-modal-header {
            padding: 20px;
            border-bottom: 1px solid #4D4D4C;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, rgba(217, 172, 79, 0.1) 0%, rgba(196, 147, 63, 0.1) 100%);
        }

        .admin-modal-title {
            font-size: 20px;
            font-weight: bold;
            color: #d9ac4f;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .admin-badge {
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            color: #242424;
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 11px;
            font-weight: bold;
        }

        .admin-tabs {
            display: flex;
            background: #333332;
            border-bottom: 1px solid #4D4D4C;
        }

        .admin-tab {
            flex: 1;
            padding: 14px;
            border: none;
            background: transparent;
            color: #A8A5A1;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }

        .admin-tab.active {
            color: #d9ac4f;
            border-bottom-color: #d9ac4f;
            background: rgba(217, 172, 79, 0.05);
        }

        .admin-tab:hover {
            background: rgba(217, 172, 79, 0.05);
        }

        .admin-modal-body {
            padding: 20px;
            overflow-y: auto;
        }

        .admin-tab-content {
            display: none;
        }

        .admin-tab-content.active {
            display: block;
        }

        .control-section {
            background: #333332;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .section-title {
            font-size: 15px;
            font-weight: bold;
            color: #F5F3F0;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .control-label {
            font-size: 13px;
            color: #A8A5A1;
            margin-bottom: 8px;
        }

        .control-value {
            font-size: 14px;
            color: #F5F3F0;
            font-weight: 600;
        }

        .result-input {
            width: 100%;
            padding: 12px;
            background: #242424;
            border: 2px solid #4D4D4C;
            border-radius: 8px;
            color: #F5F3F0;
            font-size: 18px;
            text-align: center;
            font-weight: bold;
            margin-bottom: 12px;
        }

        .result-input:focus {
            outline: none;
            border-color: #d9ac4f;
        }

        .result-preview {
            background: #242424;
            padding: 16px;
            border-radius: 10px;
            margin-bottom: 16px;
            border: 1px solid #4D4D4C;
        }

        .preview-title {
            font-size: 12px;
            color: #A8A5A1;
            margin-bottom: 10px;
        }

        .preview-content {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }

        .preview-item {
            text-align: center;
        }

        .preview-label {
            font-size: 11px;
            color: #A8A5A1;
            margin-bottom: 6px;
        }

        .preview-value {
            font-size: 20px;
            font-weight: bold;
            padding: 8px;
            border-radius: 8px;
            background: #333332;
        }

        .preview-value.number {
            color: #d9ac4f;
        }

        .preview-value.color {
            color: white;
        }

        .preview-value.color.green {
            background: #40AD72;
        }

        .preview-value.color.red {
            background: #FD565C;
        }

        .preview-value.color.violet {
            background: #9B48DB;
        }

        .preview-value.size {
            color: #d9ac4f;
        }

        .lock-result-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            border: none;
            border-radius: 8px;
            color: #242424;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .lock-result-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(217, 172, 79, 0.4);
        }

        .lock-result-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .confirmation-msg {
            background: #17B15E;
            color: white;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            margin-bottom: 16px;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from { transform: translateY(-10px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .queue-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .queue-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #242424;
            border-radius: 8px;
            border-left: 3px solid #d9ac4f;
        }

        .queue-item.next {
            border-left-color: #17B15E;
            background: rgba(23, 177, 94, 0.05);
        }

        .queue-info {
            flex: 1;
        }

        .queue-label {
            font-size: 11px;
            color: #A8A5A1;
            margin-bottom: 4px;
        }

        .queue-value {
            font-size: 14px;
            font-weight: bold;
            color: #F5F3F0;
        }

        .queue-actions {
            display: flex;
            gap: 6px;
        }

        .queue-btn {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .queue-btn.cancel {
            background: #FD565C;
            color: white;
        }

        .queue-btn.clear {
            background: #4D4D4C;
            color: #F5F3F0;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
            margin-bottom: 16px;
        }

        .stat-card {
            background: #242424;
            padding: 14px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-label {
            font-size: 11px;
            color: #A8A5A1;
            margin-bottom: 6px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: bold;
            color: #d9ac4f;
        }

        .user-settings-section {
            background: #333332;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 16px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #4D4D4C;
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .settings-label {
            font-size: 14px;
            color: #F5F3F0;
        }

        .settings-value {
            font-size: 13px;
            color: #A8A5A1;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: #A8A5A1;
            font-size: 13px;
        }

        /* Admin Authentication Modal */
        .admin-auth-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            z-index: 2500;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .admin-auth-modal.show {
            display: flex;
        }

        .admin-auth-box {
            background: #333332;
            padding: 30px;
            border-radius: 16px;
            width: 100%;
            max-width: 400px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            border: 2px solid #d9ac4f;
        }

        .admin-auth-title {
            text-align: center;
            font-size: 20px;
            font-weight: bold;
            color: #d9ac4f;
            margin-bottom: 8px;
        }

        .admin-auth-subtitle {
            text-align: center;
            font-size: 13px;
            color: #A8A5A1;
            margin-bottom: 24px;
        }

        .admin-auth-label {
            font-size: 13px;
            color: #F5F3F0;
            margin-bottom: 8px;
            display: block;
        }

        .admin-auth-input {
            width: 100%;
            padding: 14px;
            background: #242424;
            border: 2px solid #4D4D4C;
            border-radius: 8px;
            color: #F5F3F0;
            font-size: 16px;
            margin-bottom: 16px;
            text-align: center;
            font-weight: bold;
            letter-spacing: 2px;
        }

        .admin-auth-input:focus {
            outline: none;
            border-color: #d9ac4f;
        }

        .admin-auth-error {
            background: #FD565C;
            color: white;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            font-size: 13px;
            margin-bottom: 16px;
            display: none;
            animation: shake 0.5s;
        }

        .admin-auth-error.show {
            display: block;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
        }

        .admin-auth-success {
            background: #17B15E;
            color: white;
            padding: 10px;
            border-radius: 6px;
            text-align: center;
            font-size: 13px;
            margin-bottom: 16px;
            display: none;
        }

        .admin-auth-success.show {
            display: block;
        }

        .admin-auth-buttons {
            display: flex;
            gap: 10px;
        }

        .admin-auth-btn {
            flex: 1;
            padding: 14px;
            border: none;
            border-radius: 8px;
            font-weight: bold;
            font-size: 15px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .admin-auth-btn.cancel {
            background: #4D4D4C;
            color: #F5F3F0;
        }

        .admin-auth-btn.submit {
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            color: #242424;
        }

        .admin-auth-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .admin-auth-attempts {
            text-align: center;
            font-size: 12px;
            color: #A8A5A1;
            margin-top: 12px;
        }

        .admin-tab.hidden {
            display: none;
        }

        /* Login Screen */
        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a1a1a 0%, #2d2d2d 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            padding: 20px;
        }

        .login-screen.hide {
            display: none;
        }

        .login-box {
            background: #333332;
            padding: 40px 30px;
            border-radius: 16px;
            width: 100%;
            max-width: 350px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .login-logo {
            text-align: center;
            font-size: 32px;
            font-weight: bold;
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 30px;
        }

        .login-input {
            width: 100%;
            padding: 14px;
            background: #242424;
            border: 2px solid #4D4D4C;
            border-radius: 8px;
            color: #F5F3F0;
            font-size: 15px;
            margin-bottom: 16px;
        }

        .login-input:focus {
            outline: none;
            border-color: #d9ac4f;
        }

        .login-btn {
            width: 100%;
            padding: 16px;
            background: linear-gradient(135deg, #d9ac4f 0%, #c4933f 100%);
            border: none;
            border-radius: 8px;
            color: #242424;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 12px;
        }

        .toggle-auth {
            text-align: center;
            color: #A8A5A1;
            font-size: 13px;
            cursor: pointer;
        }

        .toggle-auth span {
            color: #d9ac4f;
            font-weight: 600;
        }

        /* Responsive */
        @media (max-width: 450px) {
            .mobile-container {
                border-radius: 0;
            }

            body {
                padding: 0;
            }
        }
    </style>
    <!-- Firebase SDK -->
<script type="module">
  // --- Firebase modular imports (v9+)
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
  import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-auth.js";
  import {
    getFirestore,
    collection,
    onSnapshot,
    getDocs,
    doc,
    addDoc,
    query,
    orderBy,
    where
  } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";
  import { getDatabase } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js";

  // --- Your config
  const firebaseConfig = {
    apiKey: "AIzaSyBVDbVxzGWL_mCdadd64NGkglrO92GQhI4",
    authDomain: "wingo-bd08e.firebaseapp.com",
    projectId: "wingo-bd08e",
    storageBucket: "wingo-bd08e.firebasestorage.app",
    messagingSenderId: "230746215969",
    appId: "1:230746215969:web:8656b59fda1700266e7560",
    measurementId: "G-YJ1N5CK0TH"
  };

  // --- Initialize
  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);
  const database = getDatabase(app);

  // Optional: sign in anonymously once here (you already had this working)
  signInAnonymously(auth)
    .then(() => console.log("‚úÖ Signed in anonymously to Firebase Auth"))
    .catch((err) => console.error("Firebase sign-in error:", err));

  // --- Expose firebase objects globally if other non-module scripts use them
  window.firebaseApp = app;
  window.auth = auth;
  window.db = db;
  window.database = database;

  // --- Create a global helper that sets up a live listener on "games" collection
  //     so non-module code can simply call window.listenToGames()
  window.listenToGames = function (onUpdateCallback) {
    try {
      console.log("‚ö° Starting Firestore listener for collection 'games' ...");
      const gamesRef = collection(db, "games"); // modular v9 syntax

      // Example: listen to changes
      const unsubscribe = onSnapshot(gamesRef, (snapshot) => {
        const docs = [];
        snapshot.forEach((docSnap) => {
          docs.push({ id: docSnap.id, data: docSnap.data() });
        });
        console.log("üõ∞ games snapshot:", docs);
        // If a callback supplied by caller, call it with docs
        if (typeof onUpdateCallback === "function") {
          onUpdateCallback(docs);
        }
      }, (err) => {
        console.error("Listener error:", err);
      });

      // Return unsubscribe function so caller can stop listening later
      return unsubscribe;

    } catch (err) {
      console.error("listenToGames error:", err);
      throw err;
    }
  };

  // Optional helper: one-time read of games (getDocs)
  window.getGamesOnce = async function () {
    const gamesRef = collection(db, "games");
    const snap = await getDocs(gamesRef);
    const data = [];
    snap.forEach(d => data.push({ id: d.id, data: d.data() }));
    return data;
  };

  console.log("‚úÖ Firebase initialized and helpers exposed (listenToGames, getGamesOnce).");
</script>




</head>
<body>
    <!-- Login Screen -->
    <div class="login-screen" id="loginScreen">
        <div class="login-box">
            <div class="login-logo">BDG WIN</div>
            <div id="loginForm">
                <input type="text" class="login-input" id="loginUsername" placeholder="Username">
                <input type="password" class="login-input" id="loginPassword" placeholder="Password">
                <button class="login-btn" onclick="handleLogin()">Login</button>
                <div class="toggle-auth" onclick="toggleAuthMode()">Don't have an account? <span>Sign Up</span></div>
            </div>
            <div id="signupForm" style="display: none;">
                <input type="text" class="login-input" id="signupUsername" placeholder="Username">
                <input type="password" class="login-input" id="signupPassword" placeholder="Password">
                <button class="login-btn" onclick="handleSignup()">Sign Up</button>
                <div class="toggle-auth" onclick="toggleAuthMode()">Already have an account? <span>Login</span></div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div class="mobile-container">
        <!-- Header -->
        <div class="header">
            <div class="logo">BDG WIN</div>
            <div class="settings-icon" onclick="toggleSettings()">‚öôÔ∏è</div>
        </div>

        <!-- Wallet Section -->
        <div class="wallet-section">
            <div class="wallet-info">
                <div class="wallet-label">Wallet Balance</div>
                <div class="wallet-balance">‚Çπ<span id="walletBalance">10000.00</span></div>
            </div>
            <div class="wallet-actions">
                <button class="wallet-btn deposit-btn" onclick="handleDeposit()">Deposit</button>
                <button class="wallet-btn withdraw-btn" onclick="handleWithdraw()">Withdraw</button>
            </div>
        </div>

        <!-- Game Mode Tabs -->
        <div class="game-modes" id="gameModes">
            <div class="mode-tab active" data-mode="WinGo_30S" onclick="switchGameMode('WinGo_30S')">WinGo 30sec</div>
            <div class="mode-tab" data-mode="WinGo_1M" onclick="switchGameMode('WinGo_1M')">WinGo 1 Min</div>
            <div class="mode-tab" data-mode="WinGo_3M" onclick="switchGameMode('WinGo_3M')">WinGo 3 Min</div>
            <div class="mode-tab" data-mode="WinGo_5M" onclick="switchGameMode('WinGo_5M')">WinGo 5 Min</div>
        </div>

        <!-- Game Area -->
        <div class="game-area">
            <!-- Period & Timer -->
            <div class="game-info">
                <div class="period-display">
                    <span class="period-label">Period</span>
                    <span class="period-number" id="periodNumber">20251105100051700</span>
                </div>
                <div class="countdown">
                    <div class="countdown-label">Count Down</div>
                    <div class="countdown-timer" id="countdownTimer">00:30</div>
                </div>
            </div>

            <!-- Number Grid -->
            <div class="numbers-grid" id="numbersGrid">
                <!-- Numbers 0-9 will be generated here -->
            </div>

            <!-- Color Betting -->
            <div class="color-betting">
                <button class="color-bet-btn green" onclick="openBettingModal('color', 'Green')">Green</button>
                <button class="color-bet-btn violet" onclick="openBettingModal('color', 'Violet')">Violet</button>
                <button class="color-bet-btn red" onclick="openBettingModal('color', 'Red')">Red</button>
            </div>

            <!-- Big/Small Betting -->
            <div class="size-betting">
                <button class="size-bet-btn" onclick="openBettingModal('size', 'Big')">Big (5-9)</button>
                <button class="size-bet-btn" onclick="openBettingModal('size', 'Small')">Small (0-4)</button>
            </div>

            <!-- Game History -->
            <div class="game-history">
                <div class="history-tabs">
                    <button class="history-tab active" onclick="switchHistoryTab('game')">Game history</button>
                    <button class="history-tab" onclick="switchHistoryTab('chart')">Chart</button>
                    <button class="history-tab" onclick="switchHistoryTab('my')">My history</button>
                </div>
                <div class="history-content">
                    <div class="history-table-container" id="gameHistoryContent">
                        <table class="history-table">
                            <thead>
                                <tr>
                                    <th>Period</th>
                                    <th>Number</th>
                                    <th>Big/Small</th>
                                    <th>Color</th>
                                </tr>
                            </thead>
                            <tbody id="historyTableBody">
                                <!-- History rows will be generated here -->
                            </tbody>
                        </table>
                    </div>
                    <div class="history-pagination">
                        <button class="pagination-btn" id="prevPageBtn" onclick="changePage(-1)">‚Üê</button>
                        <div class="pagination-info" id="paginationInfo">1/1</div>
                        <button class="pagination-btn" id="nextPageBtn" onclick="changePage(1)">‚Üí</button>
                    </div>
                    <div id="chartHistoryContent" style="display: none;">
                        <div class="empty-history">Chart view coming soon</div>
                    </div>
                    <div id="myHistoryContent" style="display: none;">
                        <div class="empty-history">No personal betting history yet</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Admin Authentication Modal -->
        <div class="admin-auth-modal" id="adminAuthModal">
            <div class="admin-auth-box">
                <div class="admin-auth-title">üîê ADMIN AUTHENTICATION</div>
                <div class="admin-auth-subtitle">Enter admin password to access control panel</div>
                
                <label class="admin-auth-label">Admin Password:</label>
                <input type="password" class="admin-auth-input" id="adminPasswordInput" placeholder="Enter password" maxlength="20">
                
                <div class="admin-auth-error" id="adminAuthError">‚ùå Incorrect Password</div>
                <div class="admin-auth-success" id="adminAuthSuccess">‚úÖ Admin Access Granted</div>
                
                <div class="admin-auth-buttons">
                    <button class="admin-auth-btn cancel" onclick="closeAdminAuth()">Cancel</button>
                    <button class="admin-auth-btn submit" onclick="verifyAdminPassword()" id="adminAuthSubmit">Submit</button>
                </div>
                
                <div class="admin-auth-attempts" id="adminAuthAttempts"></div>
            </div>
        </div>

        <!-- Admin Panel Modal -->
        <div class="admin-modal" id="adminModal">
            <div class="admin-modal-content">
                <div class="admin-modal-header">
                    <div class="admin-modal-title">
                        <span class="admin-badge">ADMIN</span>
                        <span>Control Panel</span>
                    </div>
                    <div class="close-btn" onclick="closeAdminPanel()">&times;</div>
                </div>
                
                <div class="admin-tabs">
                    <button class="admin-tab active" id="adminControlTabBtn" onclick="switchAdminTab('control')">Admin Control</button>
                    <button class="admin-tab" id="userSettingsTabBtn" onclick="switchAdminTab('settings')">User Settings</button>
                </div>
                
                <div class="admin-modal-body">
                    <!-- Admin Control Tab -->
                    <div class="admin-tab-content active" id="adminControlTab">
                        <div class="control-section">
                            <div class="section-title">‚öôÔ∏è Admin Result Control</div>
                            <div style="margin-bottom: 12px;">
                                <div class="control-label">Current Game Mode</div>
                                <div class="control-value" id="adminCurrentMode">WinGo 30sec</div>
                            </div>
                            <div style="margin-bottom: 12px;">
                                <div class="control-label">Round Ends In</div>
                                <div class="control-value" id="adminTimeLeft">30 seconds</div>
                            </div>
                        </div>

                        <div class="control-section">
                            <div class="section-title">üéØ Set Next Result</div>
                            <div class="control-label">Enter Number (0-9)</div>
                            <input type="number" class="result-input" id="adminResultInput" min="0" max="9" placeholder="0-9" oninput="updateResultPreview()">
                            
                            <div class="result-preview" id="resultPreview" style="display: none;">
                                <div class="preview-title">Preview:</div>
                                <div class="preview-content">
                                    <div class="preview-item">
                                        <div class="preview-label">Number</div>
                                        <div class="preview-value number" id="previewNumber">-</div>
                                    </div>
                                    <div class="preview-item">
                                        <div class="preview-label">Color</div>
                                        <div class="preview-value color" id="previewColor">-</div>
                                    </div>
                                    <div class="preview-item">
                                        <div class="preview-label">Size</div>
                                        <div class="preview-value size" id="previewSize">-</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div id="confirmationMsg" style="display: none;"></div>
                            
                            <button class="lock-result-btn" onclick="lockResult()" id="lockBtn">üîí Lock Result for Next Round</button>
                        </div>

                        <div class="control-section">
                            <div class="section-title">üìã Queued Results</div>
                            <div class="queue-list" id="queueList">
                                <div class="empty-state">No results in queue</div>
                            </div>
                        </div>

                        <div class="control-section">
                            <div class="section-title">üìä Statistics</div>
                            <div class="stats-grid">
                                <div class="stat-card">
                                    <div class="stat-label">Total Bets</div>
                                    <div class="stat-value" id="statTotalBets">0</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Platform Earnings</div>
                                    <div class="stat-value">‚Çπ<span id="statEarnings">0</span></div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Active Users</div>
                                    <div class="stat-value" id="statUsers">1</div>
                                </div>
                                <div class="stat-card">
                                    <div class="stat-label">Rounds Played</div>
                                    <div class="stat-value" id="statRounds">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- User Settings Tab -->
                    <div class="admin-tab-content" id="userSettingsTab">
                        <div class="user-settings-section">
                            <div class="section-title">üë§ Profile Information</div>
                            <div class="settings-row">
                                <div class="settings-label">Username</div>
                                <div class="settings-value" id="profileUsername">admin</div>
                            </div>
                            <div class="settings-row">
                                <div class="settings-label">Account Type</div>
                                <div class="settings-value" id="profileType">Administrator</div>
                            </div>
                            <div class="settings-row">
                                <div class="settings-label">Member Since</div>
                                <div class="settings-value">Nov 2025</div>
                            </div>
                        </div>

                        <div class="user-settings-section">
                            <div class="section-title">üîê Security</div>
                            <div class="settings-row">
                                <div class="settings-label">Change Password</div>
                                <button class="queue-btn" style="background: #d9ac4f; color: #242424;" onclick="showNotification('Password change coming soon', 'success')">Update</button>
                            </div>
                        </div>

                        <div class="user-settings-section">
                            <div class="section-title">üîî Notifications</div>
                            <div class="settings-row">
                                <div class="settings-label">Bet Confirmations</div>
                                <div class="settings-value">Enabled</div>
                            </div>
                            <div class="settings-row">
                                <div class="settings-label">Win Alerts</div>
                                <div class="settings-value">Enabled</div>
                            </div>
                            <div class="settings-row">
                                <div class="settings-label">Game Updates</div>
                                <div class="settings-value">Enabled</div>
                            </div>
                        </div>

                        <div class="user-settings-section">
                            <div class="section-title">‚ÑπÔ∏è About</div>
                            <div class="settings-row">
                                <div class="settings-label">App Version</div>
                                <div class="settings-value">1.0.0</div>
                            </div>
                            <div class="settings-row">
                                <div class="settings-label">Platform</div>
                                <div class="settings-value">BDG WIN</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Betting Modal -->
    <div class="modal" id="bettingModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">Place Your Bet</div>
                <div class="close-btn" onclick="closeBettingModal()">&times;</div>
            </div>
            <div class="modal-body">
                <!-- Quick Amounts -->
                <div class="quick-amounts" id="quickAmounts">
                    <button class="amount-btn" data-amount="1" onclick="selectAmount(1)">1</button>
                    <button class="amount-btn" data-amount="10" onclick="selectAmount(10)">10</button>
                    <button class="amount-btn" data-amount="100" onclick="selectAmount(100)">100</button>
                    <button class="amount-btn" data-amount="1000" onclick="selectAmount(1000)">1000</button>
                </div>

                <!-- Quantity Selector -->
                <div class="quantity-selector">
                    <div class="quantity-label">Quantity</div>
                    <div class="quantity-controls">
                        <button class="quantity-btn" onclick="changeQuantity(-1)">-</button>
                        <div class="quantity-value" id="quantityValue">1</div>
                        <button class="quantity-btn" onclick="changeQuantity(1)">+</button>
                    </div>
                </div>

                <!-- Multiplier Selection -->
                <div class="multiplier-section">
                    <div class="multiplier-label">Multiplier</div>
                    <div class="multiplier-grid" id="multiplierGrid">
                        <button class="multiplier-btn" data-multiplier="1" onclick="selectMultiplier(1)">X1</button>
                        <button class="multiplier-btn" data-multiplier="5" onclick="selectMultiplier(5)">X5</button>
                        <button class="multiplier-btn" data-multiplier="10" onclick="selectMultiplier(10)">X10</button>
                        <button class="multiplier-btn" data-multiplier="20" onclick="selectMultiplier(20)">X20</button>
                        <button class="multiplier-btn" data-multiplier="50" onclick="selectMultiplier(50)">X50</button>
                        <button class="multiplier-btn" data-multiplier="100" onclick="selectMultiplier(100)">X100</button>
                    </div>
                </div>

                <!-- Total Amount -->
                <div class="total-amount">
                    <div class="total-label">Total Amount</div>
                    <div class="total-value">‚Çπ<span id="totalAmount">0</span></div>
                </div>

                <!-- Confirm Buttons -->
                <div class="confirm-buttons">
                    <button class="confirm-btn cancel" onclick="closeBettingModal()">Cancel</button>
                    <button class="confirm-btn submit" onclick="confirmBet()">Confirm Bet</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification"></div>

    <script>
        // ===== GAME STATE =====
        const GAME_STATE = {
            currentUser: null,
            isAdmin: false,
            isAdminAuthenticated: false,
            adminPasswordAttempts: 0,
            currentMode: 'WinGo_30S',
            balance: 10000,
            modes: {
                'WinGo_30S': { duration: 30, period: 20251105100051700, timeLeft: 30, history: [] },
                'WinGo_1M': { duration: 60, period: 20251105200051700, timeLeft: 60, history: [] },
                'WinGo_3M': { duration: 180, period: 20251105300051700, timeLeft: 180, history: [] },
                'WinGo_5M': { duration: 300, period: 20251105400051700, timeLeft: 300, history: [] }
            },
            adminResults: {}, // Stores admin-locked results for each mode
            currentBet: {
                type: null, // 'number', 'color', 'size'
                value: null,
                amount: 0,
                quantity: 1,
                multiplier: 1
            },
            activeBets: [],
            statistics: {
                totalBets: 0,
                platformEarnings: 0,
                totalRounds: 0
            }
        };

        // Number properties
        const NUMBER_PROPS = {
            0: { color: 'Violet', size: 'both', cssClass: 'violet' },
            1: { color: 'Green', size: 'small', cssClass: 'green' },
            2: { color: 'Red', size: 'small', cssClass: 'red' },
            3: { color: 'Green', size: 'small', cssClass: 'green' },
            4: { color: 'Red', size: 'small', cssClass: 'red' },
            5: { color: 'Violet', size: 'both', cssClass: 'violet' },
            6: { color: 'Red', size: 'big', cssClass: 'red' },
            7: { color: 'Green', size: 'big', cssClass: 'green' },
            8: { color: 'Red', size: 'big', cssClass: 'red' },
            9: { color: 'Green', size: 'big', cssClass: 'green' }
        };

        // ===== INITIALIZATION =====
        function init() {
            generateNumberGrid();
            updateUI();
            startGameTimer();
            
            // Show admin panel if user is admin
            checkAdminStatus();
        }

        // ===== AUTH FUNCTIONS =====
        function toggleAuthMode() {
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            if (loginForm.style.display === 'none') {
                loginForm.style.display = 'block';
                signupForm.style.display = 'none';
            } else {
                loginForm.style.display = 'none';
                signupForm.style.display = 'block';
            }
        }

        function handleLogin() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            if (!username || !password) {
                showNotification('Please enter username and password', 'error');
                return;
            }

            // Check if admin credentials (username check only for login)
            if (username.toLowerCase() === 'admin') {
                GAME_STATE.isAdmin = true;
                GAME_STATE.currentUser = 'admin';
                GAME_STATE.isAdminAuthenticated = false; // Will need to auth later
                showNotification('Welcome Admin! Use settings to access admin panel.', 'success');
            } else {
                GAME_STATE.isAdmin = false;
                GAME_STATE.isAdminAuthenticated = false;
                GAME_STATE.currentUser = username;
                showNotification('Login successful!', 'success');
            }

            document.getElementById('loginScreen').classList.add('hide');
            init();
        }

        function handleSignup() {
            const username = document.getElementById('signupUsername').value;
            const password = document.getElementById('signupPassword').value;
            
            if (!username || !password) {
                showNotification('Please enter username and password', 'error');
                return;
            }

            GAME_STATE.currentUser = username;
            showNotification('Account created successfully!', 'success');
            document.getElementById('loginScreen').classList.add('hide');
            init();
        }

        function checkAdminStatus() {
            if (GAME_STATE.isAdmin) {
                // Admin panel will be shown when settings is clicked
            }
        }

        // ===== UI FUNCTIONS =====
        function generateNumberGrid() {
            const grid = document.getElementById('numbersGrid');
            grid.innerHTML = '';
            for (let i = 0; i <= 9; i++) {
                const props = NUMBER_PROPS[i];
                const ball = document.createElement('div');
                ball.className = `number-ball ${props.cssClass}`;
                ball.textContent = i;
                ball.onclick = () => openBettingModal('number', i);
                grid.appendChild(ball);
            }
        }

        function updateUI() {
            const mode = GAME_STATE.modes[GAME_STATE.currentMode];
            document.getElementById('walletBalance').textContent = GAME_STATE.balance.toFixed(2);
            document.getElementById('periodNumber').textContent = mode.period;
            updateCountdown();
            updateHistory();
            updateAdminPanel();
        }

        function updateCountdown() {
            const mode = GAME_STATE.modes[GAME_STATE.currentMode];
            const minutes = Math.floor(mode.timeLeft / 60);
            const seconds = mode.timeLeft % 60;
            document.getElementById('countdownTimer').textContent = 
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        // Pagination state
        const PAGINATION_STATE = {
            currentPage: 1,
            itemsPerPage: 10,
            totalPages: 1
        };

        function updateHistory() {
            const mode = GAME_STATE.modes[GAME_STATE.currentMode];
            const history = mode.history || [];
            
            // Calculate pagination
            PAGINATION_STATE.totalPages = Math.max(1, Math.ceil(history.length / PAGINATION_STATE.itemsPerPage));
            if (PAGINATION_STATE.currentPage > PAGINATION_STATE.totalPages) {
                PAGINATION_STATE.currentPage = PAGINATION_STATE.totalPages;
            }
            
            // Get items for current page
            const startIndex = (PAGINATION_STATE.currentPage - 1) * PAGINATION_STATE.itemsPerPage;
            const endIndex = startIndex + PAGINATION_STATE.itemsPerPage;
            const pageItems = history.slice(startIndex, endIndex);
            
            // Update table
            const tbody = document.getElementById('historyTableBody');
            if (pageItems.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" style="text-align: center; padding: 40px; color: #A8A5A1;">No game history yet</td></tr>';
            } else {
                tbody.innerHTML = pageItems.map(item => {
                    const props = NUMBER_PROPS[item.number];
                    const sizeText = props.size === 'both' ? (item.number >= 5 ? 'Big' : 'Small') : (props.size === 'big' ? 'Big' : 'Small');
                    
                    // Determine color dots
                    let colorDots = '';
                    if (props.color === 'Violet') {
                        // Show both red and green dots for violet
                        colorDots = '<span class="color-dot red"></span><span class="color-dot green"></span>';
                    } else if (props.color === 'Red') {
                        colorDots = '<span class="color-dot red"></span>';
                    } else if (props.color === 'Green') {
                        colorDots = '<span class="color-dot green"></span>';
                    }
                    
                    return `
                        <tr>
                            <td class="history-period-cell">${item.period}</td>
                            <td class="history-number-cell ${props.cssClass}">${item.number}</td>
                            <td class="history-size-cell">${sizeText}</td>
                            <td class="history-color-cell">${colorDots}</td>
                        </tr>
                    `;
                }).join('');
            }
            
            // Update pagination controls
            updatePaginationControls();
        }
        
        function updatePaginationControls() {
            const prevBtn = document.getElementById('prevPageBtn');
            const nextBtn = document.getElementById('nextPageBtn');
            const paginationInfo = document.getElementById('paginationInfo');
            
            paginationInfo.textContent = `${PAGINATION_STATE.currentPage}/${PAGINATION_STATE.totalPages}`;
            
            prevBtn.disabled = PAGINATION_STATE.currentPage === 1;
            nextBtn.disabled = PAGINATION_STATE.currentPage === PAGINATION_STATE.totalPages;
        }
        
        function changePage(delta) {
            const newPage = PAGINATION_STATE.currentPage + delta;
            if (newPage >= 1 && newPage <= PAGINATION_STATE.totalPages) {
                PAGINATION_STATE.currentPage = newPage;
                updateHistory();
            }
        }
        
        function switchHistoryTab(tab) {
            // Update tab buttons
            document.querySelectorAll('.history-tab').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Hide all content
            document.getElementById('gameHistoryContent').style.display = 'none';
            document.getElementById('chartHistoryContent').style.display = 'none';
            document.getElementById('myHistoryContent').style.display = 'none';
            document.querySelector('.history-pagination').style.display = 'none';
            
            // Show selected content
            if (tab === 'game') {
                document.getElementById('gameHistoryContent').style.display = 'block';
                document.querySelector('.history-pagination').style.display = 'flex';
            } else if (tab === 'chart') {
                document.getElementById('chartHistoryContent').style.display = 'block';
            } else if (tab === 'my') {
                document.getElementById('myHistoryContent').style.display = 'block';
            }
        }

        function updateAdminPanel() {
            const modeNames = {
                'WinGo_30S': 'WinGo 30sec',
                'WinGo_1M': 'WinGo 1 Min',
                'WinGo_3M': 'WinGo 3 Min',
                'WinGo_5M': 'WinGo 5 Min'
            };
            
            // Update current mode info
            document.getElementById('adminCurrentMode').textContent = modeNames[GAME_STATE.currentMode];
            
            const mode = GAME_STATE.modes[GAME_STATE.currentMode];
            document.getElementById('adminTimeLeft').textContent = `${mode.timeLeft} seconds`;
            
            // Update queue list
            const queueList = document.getElementById('queueList');
            const queueEntries = Object.entries(GAME_STATE.adminResults);
            
            if (queueEntries.length === 0) {
                queueList.innerHTML = '<div class="empty-state">No results in queue</div>';
            } else {
                queueList.innerHTML = queueEntries.map(([modeId, result], index) => {
                    const props = NUMBER_PROPS[result];
                    const isNext = modeId === GAME_STATE.currentMode;
                    const modeTime = GAME_STATE.modes[modeId].timeLeft;
                    
                    return `
                        <div class="queue-item ${isNext ? 'next' : ''}">
                            <div class="queue-info">
                                <div class="queue-label">${isNext ? 'Next Round (in ' + modeTime + 's)' : modeNames[modeId]}</div>
                                <div class="queue-value">${result} (${props.color}, ${props.size === 'both' ? 'Both' : props.size.charAt(0).toUpperCase() + props.size.slice(1)})</div>
                            </div>
                            <div class="queue-actions">
                                <button class="queue-btn cancel" onclick="cancelQueuedResult('${modeId}')">Cancel</button>
                            </div>
                        </div>
                    `;
                }).join('') + (queueEntries.length > 1 ? '<button class="lock-result-btn" style="margin-top: 12px;" onclick="clearAllQueue()">Clear All Queue</button>' : '');
            }
            
            // Update statistics
            document.getElementById('statTotalBets').textContent = GAME_STATE.statistics.totalBets;
            document.getElementById('statEarnings').textContent = GAME_STATE.statistics.platformEarnings.toFixed(2);
            document.getElementById('statUsers').textContent = GAME_STATE.currentUser ? '1' : '0';
            document.getElementById('statRounds').textContent = GAME_STATE.statistics.totalRounds;
        }

        function updateUserSettings() {
            document.getElementById('profileUsername').textContent = GAME_STATE.currentUser || 'Guest';
            document.getElementById('profileType').textContent = GAME_STATE.isAdmin ? 'Administrator' : 'Regular User';
        }

        // ===== GAME TIMER =====
        function startGameTimer() {
            setInterval(() => {
                Object.keys(GAME_STATE.modes).forEach(modeId => {
                    const mode = GAME_STATE.modes[modeId];
                    mode.timeLeft--;
                    
                    if (mode.timeLeft <= 0) {
                        // Generate result
                        processGameResult(modeId);
                        // Reset timer
                        mode.timeLeft = mode.duration;
                        mode.period++;
                    }
                });
                
                // Update UI only for current mode
                updateCountdown();
            }, 1000);
        }

        function processGameResult(modeId) {
            const mode = GAME_STATE.modes[modeId];
            
            // Check if admin set result
            let resultNumber;
            if (GAME_STATE.adminResults[modeId] !== undefined) {
                resultNumber = GAME_STATE.adminResults[modeId];
                delete GAME_STATE.adminResults[modeId]; // Consume the result
                if (modeId === GAME_STATE.currentMode) {
                    showNotification(`üéØ Admin Result Used: ${resultNumber}`, 'success');
                }
            } else {
                // Random result
                resultNumber = Math.floor(Math.random() * 10);
            }
            
            // Add to history
            mode.history.unshift({
                period: mode.period,
                number: resultNumber
            });
            
            // Keep only last 50 results
            if (mode.history.length > 50) {
                mode.history = mode.history.slice(0, 50);
            }
            
            // Update statistics
            GAME_STATE.statistics.totalRounds++;
            
            // Process active bets for this mode
            processBets(modeId, resultNumber);
            
            // Update UI
            if (modeId === GAME_STATE.currentMode) {
                updateHistory();
            }
            
            updateAdminPanel();
        }

        function processBets(modeId, resultNumber) {
            const props = NUMBER_PROPS[resultNumber];
            const betsToProcess = GAME_STATE.activeBets.filter(bet => bet.mode === modeId);
            
            betsToProcess.forEach(bet => {
                let win = false;
                let payout = 0;
                
                if (bet.type === 'number' && bet.value === resultNumber) {
                    win = true;
                    payout = bet.totalAmount * 9; // 8x + original bet
                } else if (bet.type === 'color' && bet.value === props.color) {
                    win = true;
                    // Violet numbers (0, 5) pay 4.5x, others 1.9x
                    if (props.color === 'Violet') {
                        payout = bet.totalAmount * 4.5;
                    } else {
                        payout = bet.totalAmount * 1.9;
                    }
                } else if (bet.type === 'size') {
                    const isSmall = resultNumber >= 0 && resultNumber <= 4;
                    const isBig = resultNumber >= 5 && resultNumber <= 9;
                    if ((bet.value === 'Small' && isSmall) || (bet.value === 'Big' && isBig)) {
                        win = true;
                        payout = bet.totalAmount * 1.9;
                    }
                }
                
                if (win) {
                    GAME_STATE.balance += payout;
                    const profit = payout - bet.totalAmount;
                    GAME_STATE.statistics.platformEarnings -= profit; // User won, platform loses
                    if (modeId === GAME_STATE.currentMode) {
                        showNotification(`üéâ You Won ‚Çπ${payout.toFixed(2)}!`, 'success');
                    }
                } else {
                    GAME_STATE.statistics.platformEarnings += bet.totalAmount; // User lost, platform earns
                    if (modeId === GAME_STATE.currentMode) {
                        showNotification(`Lost bet on ${bet.type}: ${bet.value}`, 'error');
                    }
                }
                
                // Remove processed bet
                GAME_STATE.activeBets = GAME_STATE.activeBets.filter(b => b !== bet);
            });
            
            updateUI();
        }

        // ===== BETTING FUNCTIONS =====
        function openBettingModal(type, value) {
            const mode = GAME_STATE.modes[GAME_STATE.currentMode];
            if (mode.timeLeft < 10) {
                showNotification('Betting closed! Wait for next round', 'error');
                return;
            }
            
            GAME_STATE.currentBet = {
                type: type,
                value: value,
                amount: 1,
                quantity: 1,
                multiplier: 1
            };
            
            const modal = document.getElementById('bettingModal');
            const title = document.getElementById('modalTitle');
            
            if (type === 'number') {
                title.textContent = `Bet on Number ${value}`;
            } else if (type === 'color') {
                title.textContent = `Bet on ${value}`;
            } else if (type === 'size') {
                title.textContent = `Bet on ${value}`;
            }
            
            // Reset selections
            document.querySelectorAll('.amount-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelectorAll('.multiplier-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-amount="1"]').classList.add('active');
            document.querySelector('[data-multiplier="1"]').classList.add('active');
            document.getElementById('quantityValue').textContent = '1';
            
            updateTotalAmount();
            modal.classList.add('show');
        }

        function closeBettingModal() {
            document.getElementById('bettingModal').classList.remove('show');
        }

        function selectAmount(amount) {
            GAME_STATE.currentBet.amount = amount;
            document.querySelectorAll('.amount-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-amount="${amount}"]`).classList.add('active');
            updateTotalAmount();
        }

        function changeQuantity(delta) {
            const newQuantity = GAME_STATE.currentBet.quantity + delta;
            if (newQuantity >= 1 && newQuantity <= 100) {
                GAME_STATE.currentBet.quantity = newQuantity;
                document.getElementById('quantityValue').textContent = newQuantity;
                updateTotalAmount();
            }
        }

        function selectMultiplier(multiplier) {
            GAME_STATE.currentBet.multiplier = multiplier;
            document.querySelectorAll('.multiplier-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-multiplier="${multiplier}"]`).classList.add('active');
            updateTotalAmount();
        }

        function updateTotalAmount() {
            const total = GAME_STATE.currentBet.amount * GAME_STATE.currentBet.quantity * GAME_STATE.currentBet.multiplier;
            document.getElementById('totalAmount').textContent = total;
        }

        async function confirmBet() {
  const amount = selectedQuantity;
  
  if (userBalance < amount) {
    showNotification("Insufficient balance!", true);
    return;
  }
  
  // Your existing code...
  userBalance -= amount;
  updateGameDisplay();
  
  // ADD THESE FIREBASE CALLS:
  try {
    const currentPeriod = parseInt(document.getElementById('periodId').textContent.split(': '));
    await placeBetFirebase(currentGameMode, currentBetType, currentBetValue, amount, selectedMultiplier, currentPeriod);
    await updateUserBalanceFirebase(userBalance);
  } catch (error) {
    console.error("Error saving bet to Firebase:", error);
  }
  
  // Rest of your existing code...
  closeBetModal();
  showNotification(`Bet placed: ‚Çπ${amount}`);
}

        function confirmBet() {
            const total = GAME_STATE.currentBet.amount * GAME_STATE.currentBet.quantity * GAME_STATE.currentBet.multiplier;
            
            if (total > GAME_STATE.balance) {
                showNotification('Insufficient balance!', 'error');
                return;
            }
            
            // Deduct from balance
            GAME_STATE.balance -= total;
            
            // Add to active bets
            GAME_STATE.activeBets.push({
                mode: GAME_STATE.currentMode,
                type: GAME_STATE.currentBet.type,
                value: GAME_STATE.currentBet.value,
                totalAmount: total
            });
            
            // Update statistics
            GAME_STATE.statistics.totalBets++;
            
            showNotification(`Bet placed: ‚Çπ${total}`, 'success');
            closeBettingModal();
            updateUI();
        }

        // ===== GAME MODE SWITCHING =====
        function switchGameMode(modeId) {
            GAME_STATE.currentMode = modeId;
            
            // Update tabs
            document.querySelectorAll('.mode-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-mode="${modeId}"]`).classList.add('active');
            
            updateUI();
        }

        // ===== ADMIN FUNCTIONS =====
        function toggleSettings() {
            // Check if user is admin
            if (GAME_STATE.isAdmin) {
                // Check if already authenticated this session
                if (GAME_STATE.isAdminAuthenticated) {
                    // Show full admin panel
                    showAdminPanel(true);
                } else {
                    // Show authentication prompt
                    showAdminAuthPrompt();
                }
            } else {
                // Regular user - show only user settings
                showAdminPanel(false);
            }
        }

        function showAdminAuthPrompt() {
            const authModal = document.getElementById('adminAuthModal');
            const passwordInput = document.getElementById('adminPasswordInput');
            const errorMsg = document.getElementById('adminAuthError');
            const successMsg = document.getElementById('adminAuthSuccess');
            const attemptsMsg = document.getElementById('adminAuthAttempts');
            
            // Reset fields
            passwordInput.value = '';
            errorMsg.classList.remove('show');
            successMsg.classList.remove('show');
            
            // Show attempts if any
            if (GAME_STATE.adminPasswordAttempts > 0) {
                const remaining = 3 - GAME_STATE.adminPasswordAttempts;
                attemptsMsg.textContent = `Attempts remaining: ${remaining}/3`;
                if (remaining === 0) {
                    attemptsMsg.textContent = 'Maximum attempts reached. Please refresh the page.';
                    document.getElementById('adminAuthSubmit').disabled = true;
                }
            } else {
                attemptsMsg.textContent = '';
            }
            
            authModal.classList.add('show');
            passwordInput.focus();
            
            // Allow Enter key to submit
            passwordInput.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    verifyAdminPassword();
                }
            };
        }

        function closeAdminAuth() {
            const authModal = document.getElementById('adminAuthModal');
            authModal.classList.remove('show');
        }

        function verifyAdminPassword() {
            const passwordInput = document.getElementById('adminPasswordInput');
            const password = passwordInput.value;
            const errorMsg = document.getElementById('adminAuthError');
            const successMsg = document.getElementById('adminAuthSuccess');
            const submitBtn = document.getElementById('adminAuthSubmit');
            
            // Check max attempts
            if (GAME_STATE.adminPasswordAttempts >= 3) {
                errorMsg.textContent = '‚ùå Maximum attempts exceeded. Refresh page to try again.';
                errorMsg.classList.add('show');
                submitBtn.disabled = true;
                return;
            }
            
            // Verify password
            if (password === 'admin123') {
                // Correct password
                GAME_STATE.isAdminAuthenticated = true;
                GAME_STATE.adminPasswordAttempts = 0;
                
                // Show success message
                errorMsg.classList.remove('show');
                successMsg.classList.add('show');
                
                // Wait a moment then open admin panel
                setTimeout(() => {
                    closeAdminAuth();
                    showAdminPanel(true);
                    showNotification('‚úÖ Admin authentication successful!', 'success');
                }, 1000);
            } else {
                // Wrong password
                GAME_STATE.adminPasswordAttempts++;
                const remaining = 3 - GAME_STATE.adminPasswordAttempts;
                
                if (remaining > 0) {
                    errorMsg.textContent = `‚ùå Incorrect Password (${remaining} attempts remaining)`;
                } else {
                    errorMsg.textContent = '‚ùå Maximum attempts reached. Please refresh the page.';
                    submitBtn.disabled = true;
                }
                
                errorMsg.classList.add('show');
                successMsg.classList.remove('show');
                passwordInput.value = '';
                passwordInput.focus();
                
                // Update attempts display
                const attemptsMsg = document.getElementById('adminAuthAttempts');
                if (remaining > 0) {
                    attemptsMsg.textContent = `Attempts remaining: ${remaining}/3`;
                } else {
                    attemptsMsg.textContent = 'Maximum attempts reached. Please refresh the page.';
                }
            }
        }

        function showAdminPanel(isAdmin) {
            const modal = document.getElementById('adminModal');
            const adminControlTab = document.getElementById('adminControlTabBtn');
            const userSettingsTab = document.getElementById('userSettingsTabBtn');
            const adminControlContent = document.getElementById('adminControlTab');
            const userSettingsContent = document.getElementById('userSettingsTab');
            
            if (isAdmin && GAME_STATE.isAdminAuthenticated) {
                // Show both tabs for authenticated admin
                adminControlTab.classList.remove('hidden');
                userSettingsTab.classList.remove('hidden');
                
                // Show admin control tab by default
                adminControlTab.classList.add('active');
                userSettingsTab.classList.remove('active');
                adminControlContent.classList.add('active');
                userSettingsContent.classList.remove('active');
                
                updateAdminPanel();
            } else {
                // Regular user - only show user settings
                adminControlTab.classList.add('hidden');
                userSettingsTab.classList.remove('hidden');
                
                // Show user settings tab
                userSettingsTab.classList.add('active');
                adminControlTab.classList.remove('active');
                userSettingsContent.classList.add('active');
                adminControlContent.classList.remove('active');
                
                updateUserSettings();
            }
            
            modal.classList.add('show');
        }

        function closeAdminPanel() {
            const modal = document.getElementById('adminModal');
            modal.classList.remove('show');
        }

        function switchAdminTab(tabName) {
            // Update tab buttons
            document.querySelectorAll('.admin-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update tab content
            document.querySelectorAll('.admin-tab-content').forEach(content => content.classList.remove('active'));
            if (tabName === 'control') {
                document.getElementById('adminControlTab').classList.add('active');
                updateAdminPanel();
            } else {
                document.getElementById('userSettingsTab').classList.add('active');
                updateUserSettings();
            }
        }

        function updateResultPreview() {
            const input = document.getElementById('adminResultInput');
            const preview = document.getElementById('resultPreview');
            const value = parseInt(input.value);
            
            if (isNaN(value) || value < 0 || value > 9) {
                preview.style.display = 'none';
                return;
            }
            
            preview.style.display = 'block';
            const props = NUMBER_PROPS[value];
            
            document.getElementById('previewNumber').textContent = value;
            
            const colorEl = document.getElementById('previewColor');
            colorEl.textContent = props.color;
            colorEl.className = 'preview-value color ' + props.cssClass;
            
            const sizeEl = document.getElementById('previewSize');
            if (props.size === 'both') {
                sizeEl.textContent = 'Both';
            } else {
                sizeEl.textContent = props.size.charAt(0).toUpperCase() + props.size.slice(1);
            }
        }

        function lockResult() {
            const input = document.getElementById('adminResultInput');
            const resultNumber = parseInt(input.value);
            
            if (isNaN(resultNumber) || resultNumber < 0 || resultNumber > 9) {
                showNotification('Please enter a valid number (0-9)', 'error');
                return;
            }
            
            GAME_STATE.adminResults[GAME_STATE.currentMode] = resultNumber;
            
            // Show confirmation
            const props = NUMBER_PROPS[resultNumber];
            const modeNames = {
                'WinGo_30S': 'WinGo 30sec',
                'WinGo_1M': 'WinGo 1 Min',
                'WinGo_3M': 'WinGo 3 Min',
                'WinGo_5M': 'WinGo 5 Min'
            };
            
            const confirmMsg = document.getElementById('confirmationMsg');
            confirmMsg.className = 'confirmation-msg';
            confirmMsg.textContent = `‚úÖ Result Locked: ${resultNumber} for ${modeNames[GAME_STATE.currentMode]}`;
            confirmMsg.style.display = 'block';
            
            setTimeout(() => {
                confirmMsg.style.display = 'none';
            }, 3000);
            
            input.value = '';
            document.getElementById('resultPreview').style.display = 'none';
            
            showNotification(`üîí Result ${resultNumber} locked for next round!`, 'success');
            
            updateAdminPanel();
        }

        function cancelQueuedResult(modeId) {
            delete GAME_STATE.adminResults[modeId];
            showNotification('Queued result cancelled', 'success');
            updateAdminPanel();
        }

        function clearAllQueue() {
            GAME_STATE.adminResults = {};
            showNotification('All queued results cleared', 'success');
            updateAdminPanel();
        }

        // ===== WALLET FUNCTIONS =====
        function handleDeposit() {
            const amount = prompt('Enter deposit amount:');
            if (amount && !isNaN(amount) && parseFloat(amount) > 0) {
                GAME_STATE.balance += parseFloat(amount);
                showNotification(`Deposited ‚Çπ${amount}`, 'success');
                updateUI();
            }
        }

        function handleWithdraw() {
            const amount = prompt('Enter withdrawal amount:');
            if (amount && !isNaN(amount) && parseFloat(amount) > 0) {
                if (parseFloat(amount) <= GAME_STATE.balance) {
                    GAME_STATE.balance -= parseFloat(amount);
                    showNotification(`Withdrawn ‚Çπ${amount}`, 'success');
                    updateUI();
                } else {
                    showNotification('Insufficient balance!', 'error');
                }
            }
        }

        // ===== NOTIFICATION =====
        function showNotification(message, type = 'success') {
            const notif = document.getElementById('notification');
            notif.textContent = message;
            notif.className = `notification ${type} show`;
            setTimeout(() => {
                notif.classList.remove('show');
            }, 3000);
        }

        // Auto-start if already logged in (for demo)
        // Comment this out to require login
        // GAME_STATE.currentUser = 'guest';
        // document.getElementById('loginScreen').classList.add('hide');
        // init();
        // ==========================================
// FIREBASE INTEGRATION FOR WINGO GAME
// ==========================================

// Store all game data in Firebase
let gameSync = {
  games: {},
  userBets: [],
  gameHistory: []
};

// Initialize Firebase Connection
async function initFirebaseSync() {
  console.log("Connecting to Firebase...");
  
  // Sign in anonymously for testing
  //signInAnonymously(auth)
  //.then((userCredential) => {
    //console.log("Anonymous sign-in success:", userCredential.user.uid);
  //})
  //.catch((error) => {
    //console.error("Sign-in error:", error);
  //});
  
  // Listen for game updates in real-time
  listenToGames();
}

// Listen to all games
//function listenToGames() {
  //db.collection('games').onSnapshot(snapshot => {
    //snapshot.forEach(doc => {
      //gameSync.games[doc.id] = doc.data();
      //console.log(doc.id, doc.data());
    //});
  //});
//}

// Get current game
async function getCurrentGame(gameMode) {
  try {
    const doc = await db.collection('games').doc(gameMode).get();
    if (doc.exists) {
      return doc.data();
    }
  } catch (error) {
    console.error("Error getting game:", error);
  }
}

// Place bet in Firebase
async function placeBet(gameMode, betType, betValue, amount, multiplier) {
  // Step 1: Get user ID
  const userId = getCurrentUserId();
  console.log("User ID:", userId);
  
  // Step 2: Get current game info
  const game = await getCurrentGame(gameMode);
  console.log("Game:", game);
  
  // Step 3: Deduct from local balance
  let balance = parseFloat(localStorage.getItem('balance')) || 10000;
  balance -= amount;
  localStorage.setItem('balance', balance);
  console.log("New balance:", balance);
  
  // Step 4: Save bet to Firebase
  try {
    await db.collection('bets').add({
      userId: userId,
      gameId: gameMode,
      period: game.currentPeriod,
      betType: betType,
      betValue: betValue,
      betAmount: amount,
      multiplier: multiplier,
      result: 'pending',
      winAmount: 0,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    console.log("‚úÖ Bet saved to Firebase!");
  } catch (error) {
    console.error("‚ùå Error saving bet:", error);
  }
  
  // Step 5: Update user balance in Firebase
  try {
    await updateUserBalanceFirebase(userId, balance);
    console.log("‚úÖ Balance updated in Firebase!");
  } catch (error) {
    console.error("‚ùå Error updating balance:", error);
  }
  
  // Step 6: Show confirmation to user
  showBetConfirmation();
}

// Update user balance in Firebase
async function updateUserBalanceFirebase(userId, newBalance) {
  try {
    await db.collection('users').doc(userId).update({
      balance: newBalance
    });
    console.log("Balance updated!");
  } catch (error) {
    console.error("Error updating balance:", error);
  }
}

// Get game history from Firebase
async function getGameHistoryFromFirebase(gameMode, limit = 20) {
  try {
    const snapshot = await db.collection('gameHistory')
      .where('gameId', '==', gameMode)
      .orderBy('timestamp', 'desc')
      .limit(limit)
      .get();
    
    const history = [];
    snapshot.forEach(doc => {
      history.push(doc.data());
    });
    return history;
  } catch (error) {
    console.error("Error getting history:", error);
    return [];
  }
}

// Save game result to Firebase
async function saveGameResultToFirebase(gameMode, period, resultNumber) {
  try {
    const resultColor = getColorForNumber(resultNumber);
    const isBig = resultNumber >= 6 && resultNumber <= 9;
    
    await db.collection('gameHistory').add({
      gameId: gameMode,
      period: period,
      resultNumber: resultNumber,
      resultColor: resultColor,
      isBig: isBig,
      timestamp: firebase.firestore.FieldValue.serverTimestamp()
    });
    
    // Update game document
    await db.collection('games').doc(gameMode).update({
      result: resultNumber,
      status: 'completed'
    });
    
    console.log("Result saved!");
  } catch (error) {
    console.error("Error saving result:", error);
  }
}

// Admin: Set next result
async function adminSetNextResultFirebase(gameMode, resultNumber) {
  try {
    const resultColor = getColorForNumber(resultNumber);
    const isBig = resultNumber >= 6 && resultNumber <= 9;
    
    await db.collection('games').doc(gameMode).update({
      nextResult: resultNumber,
      nextResultColor: resultColor,
      nextResultIsBig: isBig,
      adminSet: true
    });
    
    console.log("Admin result set!");
  } catch (error) {
    console.error("Error setting admin result:", error);
  }
}

// Helper function to get color for number
function getColorForNumber(number) {
  if (number === 0 || number === 5) return 'Violet';
  if (number === 2 || number === 4 || number === 6 || number === 8) return 'Red';
  return 'Green';
}

// Initialize when page loads
window.addEventListener('load', () => {
  initFirebaseSync();
});

    </script>
</body>
</html>
